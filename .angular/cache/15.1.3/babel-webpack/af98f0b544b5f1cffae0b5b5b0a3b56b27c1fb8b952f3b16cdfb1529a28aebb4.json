{"ast":null,"code":"import { of, throwError } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nexport class UsersService {\n  constructor(router, http) {\n    this.router = router;\n    this.http = http;\n    this.apiURL = 'http://localhost:3000/';\n    this.headers = {\n      'content-type': 'application/json'\n    };\n    this.currentUser = \"\";\n    this.users = [];\n  }\n  getUsers() {\n    return this.http.get(this.apiURL + 'users').pipe(catchError(this.handleError));\n  }\n  isExists(email) {\n    return this.http.get(this.apiURL + 'users').pipe(map(users => {\n      return users.some(user => user.email === email);\n    }), catchError(this.handleError));\n  }\n  addUser(user) {\n    let body = JSON.stringify(user);\n    return this.http.post(this.apiURL + 'users', body, {\n      headers: this.headers\n    }).pipe(catchError(this.handleError));\n  }\n  login(email, password) {\n    return this.http.get(this.apiURL + 'users').pipe(map(users => {\n      const user = users.find(user => user.email === email && user.password === password);\n      if (user) {\n        try {\n          localStorage.setItem('user', email);\n        } catch (error) {\n          console.error(error);\n        }\n        return true;\n      } else {\n        return false;\n      }\n    }), switchMap(isValidLogin => {\n      if (isValidLogin) {\n        this.currentUser = email;\n        this.router.navigate(['/profile']);\n        return of(true);\n      } else {\n        return of(false);\n      }\n    }));\n  }\n  logout() {\n    localStorage.removeItem('user');\n  }\n  handleError(error) {\n    if (error.error instanceof ErrorEvent) {\n      console.error('An error occurred:', error.error.message);\n    } else {\n      console.error(`Backend returned code ${error.status}, ` + `body was: ${error.error}`);\n    }\n    return throwError('Something bad happened; please try again later.');\n  }\n}\nUsersService.ɵfac = function UsersService_Factory(t) {\n  return new (t || UsersService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.HttpClient));\n};\nUsersService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: UsersService,\n  factory: UsersService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAIA,SAAqBA,EAAE,EAAEC,UAAU,QAAQ,MAAM;AACjD,SAASC,UAAU,EAAEC,GAAG,EAAEC,SAAS,QAAQ,gBAAgB;;;;AAK3D,OAAM,MAAOC,YAAY;EAMvBC,YAAoBC,MAAc,EAAUC,IAAe;IAAvC,WAAM,GAAND,MAAM;IAAkB,SAAI,GAAJC,IAAI;IALhD,WAAM,GAAW,wBAAwB;IACzC,YAAO,GAAG;MAAC,cAAc,EAAC;IAAkB,CAAC;IAE7C,gBAAW,GAAW,EAAE;IACxB,UAAK,GAAW,EAAE;EAC6C;EAE/DC,QAAQ;IACN,OAAO,IAAI,CAACD,IAAI,CAACE,GAAG,CAAS,IAAI,CAACC,MAAM,GAAG,OAAO,CAAC,CAACC,IAAI,CACtDV,UAAU,CAAC,IAAI,CAACW,WAAW,CAAC,CAC7B;EACH;EAEAC,QAAQ,CAACC,KAAa;IACpB,OAAO,IAAI,CAACP,IAAI,CAACE,GAAG,CAAS,IAAI,CAACC,MAAM,GAAG,OAAO,CAAC,CAChDC,IAAI,CACHT,GAAG,CAACa,KAAK,IAAG;MACV,OAAOA,KAAK,CAACC,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACH,KAAK,KAAKA,KAAK,CAAC;IACjD,CAAC,CAAC,EACFb,UAAU,CAAC,IAAI,CAACW,WAAW,CAAC,CAC7B;EACL;EAEAM,OAAO,CAACD,IAAU;IAChB,IAAIE,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC;IAC/B,OAAO,IAAI,CAACV,IAAI,CAACe,IAAI,CAAC,IAAI,CAACZ,MAAM,GAAG,OAAO,EAAES,IAAI,EAAE;MACjDI,OAAO,EAAE,IAAI,CAACA;KACf,CAAC,CAACZ,IAAI,CACLV,UAAU,CAAC,IAAI,CAACW,WAAW,CAAC,CAC7B;EACH;EAEAY,KAAK,CAACV,KAAa,EAAEW,QAAgB;IACnC,OAAO,IAAI,CAAClB,IAAI,CAACE,GAAG,CAAS,IAAI,CAACC,MAAM,GAAG,OAAO,CAAC,CAChDC,IAAI,CACHT,GAAG,CAACa,KAAK,IAAG;MACV,MAAME,IAAI,GAAGF,KAAK,CAACW,IAAI,CAACT,IAAI,IAAIA,IAAI,CAACH,KAAK,KAAKA,KAAK,IAAIG,IAAI,CAACQ,QAAQ,KAAKA,QAAQ,CAAC;MACnF,IAAIR,IAAI,EAAE;QACR,IAAI;UACFU,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEd,KAAK,CAAC;SACpC,CAAC,OAAOe,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;;QAEtB,OAAO,IAAI;OACZ,MAAM;QACL,OAAO,KAAK;;IAEhB,CAAC,CAAC,EACF1B,SAAS,CAAC4B,YAAY,IAAG;MACvB,IAAIA,YAAY,EAAE;QAChB,IAAI,CAACC,WAAW,GAAGlB,KAAK;QACxB,IAAI,CAACR,MAAM,CAAC2B,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC;QAClC,OAAOlC,EAAE,CAAC,IAAI,CAAC;OAChB,MAAM;QACL,OAAOA,EAAE,CAAC,KAAK,CAAC;;IAEpB,CAAC,CAAC,CACH;EACL;EAEAmC,MAAM;IACJP,YAAY,CAACQ,UAAU,CAAC,MAAM,CAAC;EACjC;EAEQvB,WAAW,CAACiB,KAAwB;IAC1C,IAAIA,KAAK,CAACA,KAAK,YAAYO,UAAU,EAAE;MACrCN,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAACA,KAAK,CAACQ,OAAO,CAAC;KACzD,MAAM;MACLP,OAAO,CAACD,KAAK,CACX,yBAAyBA,KAAK,CAACS,MAAM,IAAI,GACzC,aAAaT,KAAK,CAACA,KAAK,EAAE,CAAC;;IAE/B,OAAO7B,UAAU,CACf,iDAAiD,CAAC;EACtD;;AA3EWI,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAAmC,SAAZnC,YAAY;EAAAoC,YAFX;AAAM","names":["of","throwError","catchError","map","switchMap","UsersService","constructor","router","http","getUsers","get","apiURL","pipe","handleError","isExists","email","users","some","user","addUser","body","JSON","stringify","post","headers","login","password","find","localStorage","setItem","error","console","isValidLogin","currentUser","navigate","logout","removeItem","ErrorEvent","message","status","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\hasan\\MyWeb\\src\\app\\services\\users.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { User } from '../model/user';\nimport { Observable, of, throwError } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UsersService {\n  apiURL: string = 'http://localhost:3000/';\n  headers = {'content-type':'application/json'};\n\n  currentUser: string = \"\"\n  users : User[] =[]\n  constructor(private router: Router, private http:HttpClient) { }\n\n  getUsers(): Observable<User[]> {\n    return this.http.get<User[]>(this.apiURL + 'users').pipe(\n      catchError(this.handleError)\n    );\n  }\n\n  isExists(email: string): Observable<boolean> {\n    return this.http.get<User[]>(this.apiURL + 'users')\n      .pipe(\n        map(users => {\n          return users.some(user => user.email === email);\n        }),\n        catchError(this.handleError)\n      );\n  }\n\n  addUser(user: User): Observable<any> {\n    let body = JSON.stringify(user)\n    return this.http.post(this.apiURL + 'users', body, {\n      headers: this.headers\n    }).pipe(\n      catchError(this.handleError)\n    );\n  }\n\n  login(email: string, password: string): Observable<boolean> {\n    return this.http.get<User[]>(this.apiURL + 'users')\n      .pipe(\n        map(users => {\n          const user = users.find(user => user.email === email && user.password === password);\n          if (user) {\n            try {\n              localStorage.setItem('user', email);\n            } catch (error) {\n              console.error(error);\n            }\n            return true;\n          } else {\n            return false;\n          }\n        }),\n        switchMap(isValidLogin => {\n          if (isValidLogin) {\n            this.currentUser = email;\n            this.router.navigate(['/profile']);\n            return of(true);\n          } else {\n            return of(false);\n          }\n        }),\n      );\n  }\n\n  logout() {\n    localStorage.removeItem('user');\n  }\n\n  private handleError(error: HttpErrorResponse) {\n    if (error.error instanceof ErrorEvent) {\n      console.error('An error occurred:', error.error.message);\n    } else {\n      console.error(\n        `Backend returned code ${error.status}, ` +\n        `body was: ${error.error}`);\n    }\n    return throwError(\n      'Something bad happened; please try again later.');\n  };\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}